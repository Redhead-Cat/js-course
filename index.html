<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Lesson25</title>
    <style>
      .case, .case_btn, .toDoList{
        margin:10px 15px;
        padding:5px 10px; 
      }
      .wrap {
      display: flex; 
      justify-content:space-between;
      }
      .toDoList {
        width:300px;
        min-height: 150px;
        border: 1px solid;
      }
      .toDO_item {
        line-height:2.5;
      }
      .toDO_item_done {
        text-decoration:line-through;
      }
      .done_btn, .delete_btn {
        margin:10px 5px;
        padding:5px 10px
      }
      .done_btn {
        background: green;
        border: none;
      }
      .delete_btn {
        background: red;
        border: none;
      }

    </style>
</head>
<form>
  <input class="case" name="case" type="text" placeholder="Add case">
  <button class="case_btn" type="submit">ADD</button><br>
</form>
<div class="toDoList"></div>
<body>
    <script>
      'use strict';
     if (localStorage.storageCases){
      printToDoList(JSON.parse(localStorage.storageCases));
     }
     
     document.forms[0].addEventListener ('submit',(e)=>{

       e.preventDefault();
       const cases=localStorage.storageCases ? JSON.parse(localStorage.storageCases) : [];
       const item = e.target.elements.case.value;
       const toDOItem={
         id:Date.now(),
         value:item,
         done:false
       }
       cases.push(toDOItem);
       localStorage.storageCases=JSON.stringify(cases);
       printToDoList(cases);
     })
      function printToDoList(cases){
        let casesStr='';
        cases.forEach(toDOItem => {
           casesStr+=`<div class="wrap">
                     <div class="toDO_item"><span>${toDOItem.value}</span></div>
                     <div>
                     <button id="${toDOItem.id}" type="submit" class="done_btn" data-action="done">+</button>
                     <button id="${toDOItem.id}" type="reset" class="delete_btn" data-action="delete">-</button>
                     </div>
                     </div>`               
        });  
        document.querySelector('.toDoList').innerHTML=casesStr;
      }

      const toDoList=document.querySelector('.toDoList');

      toDoList.addEventListener('click',(e)=>{
        const caseItem=JSON.parse(localStorage.storageCases);
        caseItem.forEach((el,i)=>{
          if(el.id=== +e.target.id){
            if(e.target.dataset.action==='done'){
              if(el.done){
                el.done=false;
                e.target.closest('.wrap')
               .querySelector('.toDO_item > span')
               .classList
               .remove('toDO_item_done');
              } else {
                el.done=true;
                e.target.closest('.wrap')
               .querySelector('.toDO_item > span')
               .classList
               .add('toDO_item_done');
              }
            } else if(e.target.dataset.action==='delete'){
              caseItem.splice(i,1);
              printToDoList(caseItem);
            }
          } 
        })
        localStorage.storageCases=JSON.stringify(caseItem);
      });
      
      </script>
</body>
</html>
